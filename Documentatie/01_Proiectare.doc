<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Capitolul 1: Proiectare</title>
<!--[if gte mso 9]>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>100</w:Zoom>
<w:DoNotOptimizeForBrowser/>
</w:WordDocument>
</xml>
<![endif]-->
<style>
@page {
    size: A4;
    margin: 2.5cm;
}
body {
    font-family: 'Times New Roman', Times, serif;
    font-size: 12pt;
    line-height: 1.5;
    text-align: justify;
}
h1 {
    font-size: 18pt;
    font-weight: bold;
    color: #1a1a1a;
    text-align: center;
    margin-top: 24pt;
    margin-bottom: 18pt;
    page-break-before: always;
}
h1:first-of-type {
    page-break-before: avoid;
}
h2 {
    font-size: 14pt;
    font-weight: bold;
    color: #2c2c2c;
    margin-top: 18pt;
    margin-bottom: 12pt;
    border-bottom: 1px solid #cccccc;
    padding-bottom: 6pt;
}
h3 {
    font-size: 12pt;
    font-weight: bold;
    color: #3c3c3c;
    margin-top: 14pt;
    margin-bottom: 10pt;
}
h4 {
    font-size: 12pt;
    font-weight: bold;
    font-style: italic;
    color: #4c4c4c;
    margin-top: 12pt;
    margin-bottom: 8pt;
}
p {
    margin-bottom: 10pt;
    text-indent: 1cm;
}
p.no-indent {
    text-indent: 0;
}
table {
    border-collapse: collapse;
    width: 100%;
    margin: 12pt 0;
    font-size: 11pt;
}
th, td {
    border: 1px solid #000000;
    padding: 6pt 8pt;
    text-align: left;
}
th {
    background-color: #f0f0f0;
    font-weight: bold;
}
pre, code {
    font-family: 'Courier New', Courier, monospace;
    font-size: 10pt;
    background-color: #f5f5f5;
    border: 1px solid #e0e0e0;
    padding: 2pt 4pt;
}
pre {
    padding: 10pt;
    margin: 10pt 0;
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
}
.code-block {
    background-color: #f8f8f8;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 12pt;
    margin: 12pt 0;
    font-family: 'Courier New', Courier, monospace;
    font-size: 9pt;
    line-height: 1.4;
    white-space: pre-wrap;
}
.diagram {
    font-family: 'Courier New', Courier, monospace;
    font-size: 8pt;
    line-height: 1.2;
    background-color: #fafafa;
    border: 1px solid #ccc;
    padding: 15pt;
    margin: 15pt 0;
    white-space: pre;
    overflow-x: auto;
}
ul, ol {
    margin-left: 1cm;
    margin-bottom: 10pt;
}
li {
    margin-bottom: 4pt;
}
.highlight {
    background-color: #ffffcc;
    padding: 2pt 4pt;
}
.note {
    background-color: #e7f3fe;
    border-left: 4px solid #2196F3;
    padding: 10pt;
    margin: 12pt 0;
}
.toc {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    padding: 15pt;
    margin: 20pt 0;
}
.toc-title {
    font-weight: bold;
    font-size: 14pt;
    margin-bottom: 10pt;
}
.center {
    text-align: center;
}
.page-break {
    page-break-after: always;
}
</style>
</head>
<body>

<h1>Capitolul 1: Proiectare</h1>

<div class="toc">
<p class="toc-title no-indent">Cuprins Capitol</p>
<p class="no-indent">1.1 Paradigme Utilizate</p>
<p class="no-indent" style="margin-left: 1cm;">1.1.1 Model-View-Controller (MVC)</p>
<p class="no-indent" style="margin-left: 1cm;">1.1.2 Web API (REST)</p>
<p class="no-indent" style="margin-left: 1cm;">1.1.3 ORM Code First</p>
<p class="no-indent" style="margin-left: 1cm;">1.1.4 ORM Database First</p>
<p class="no-indent" style="margin-left: 1cm;">1.1.5 Dependency Injection</p>
<p class="no-indent">1.2 Justificarea Alegerilor</p>
<p class="no-indent">1.3 Arhitectura Aplicației</p>
<p class="no-indent" style="margin-left: 1cm;">1.3.1 Diagramă Arhitecturală</p>
<p class="no-indent" style="margin-left: 1cm;">1.3.2 Descrierea Modulelor</p>
<p class="no-indent" style="margin-left: 1cm;">1.3.3 Fluxul de Date</p>
<p class="no-indent" style="margin-left: 1cm;">1.3.4 Cross-Cutting Concerns</p>
<p class="no-indent">1.4 Diagrama Entitate-Relație</p>
<p class="no-indent">1.5 Structura Soluției Visual Studio</p>
<p class="no-indent">1.6 Concluzii</p>
</div>

<h2>1.1 Paradigme Utilizate</h2>

<p>Aplicația <strong>eBooks</strong> este o platformă de gestiune a cărților electronice, construită pe baza tehnologiilor .NET și implementează următoarele paradigme de programare și design patterns:</p>

<h3>1.1.1 Model-View-Controller (MVC)</h3>

<p>Aplicația utilizează <strong>ASP.NET MVC 5</strong> ca framework principal pentru interfața web.</p>

<p><strong>Implementare în proiect:</strong></p>
<ul>
<li><strong>Models</strong> (<code>eBooks_MVC/Models/</code>): Conține ViewModels precum <code>CarteViewModel</code>, <code>LoginViewModel</code>, <code>RegisterViewModel</code></li>
<li><strong>Views</strong> (<code>eBooks_MVC/Views/</code>): Template-uri Razor (.cshtml) organizate pe controllere</li>
<li><strong>Controllers</strong> (<code>eBooks_MVC/Controllers/</code>): Controllere care gestionează logica de prezentare</li>
</ul>

<p class="no-indent"><strong>Structura proiectului MVC:</strong></p>
<div class="code-block">eBooks_MVC/
├── Controllers/
│   ├── HomeController.cs
│   ├── CartiController.cs
│   ├── AutoriController.cs
│   ├── UtilizatorController.cs
│   ├── AccountController.cs
│   └── AdminController.cs
├── Models/
│   ├── CarteViewModel.cs
│   ├── LoginViewModel.cs
│   └── RegisterViewModel.cs
└── Views/
    ├── Home/
    ├── Carti/
    ├── Autori/
    ├── Account/
    └── Shared/</div>

<h3>1.1.2 Web API (REST)</h3>

<p>Aplicația expune servicii REST prin <strong>ASP.NET Web API 2</strong> pentru comunicare programatică.</p>

<p><strong>Implementare în proiect:</strong></p>
<ul>
<li><strong>API Controllers</strong> (<code>eBooks_API/Controllers/</code>): Endpoint-uri RESTful pentru resurse</li>
<li><strong>Rutare</strong>: Configurată în <code>WebApiConfig.cs</code> cu prefix <code>/api/</code></li>
</ul>

<p class="no-indent"><strong>Structura proiectului API:</strong></p>
<div class="code-block">eBooks_API/
├── Controllers/
│   ├── CartiController.cs      // GET /api/Carti, GET /api/Carti/{id}
│   ├── AutoriController.cs     // GET /api/Autori
│   └── ValuesController.cs
└── App_Start/
    └── WebApiConfig.cs</div>

<p class="no-indent"><strong>Exemple de endpoint-uri:</strong></p>
<table>
<tr><th>Metodă</th><th>Endpoint</th><th>Descriere</th></tr>
<tr><td>GET</td><td><code>/api/Carti</code></td><td>Returnează toate cărțile</td></tr>
<tr><td>GET</td><td><code>/api/Carti/{id}</code></td><td>Returnează o carte după ID</td></tr>
<tr><td>GET</td><td><code>/api/Autori</code></td><td>Returnează toți autorii</td></tr>
</table>

<h3>1.1.3 ORM Code First (Entity Framework)</h3>

<p>Aplicația utilizează <strong>Entity Framework 6</strong> cu abordarea <strong>Code First</strong> pentru definirea și evoluția schemei bazei de date.</p>

<p><strong>Implementare în proiect:</strong></p>
<ul>
<li><strong>Modele de domeniu</strong> (<code>Repository_CodeFirst/LibrarieModele/</code>): Clase POCO cu Data Annotations</li>
<li><strong>Context</strong> (<code>Repository_CodeFirst/eBooksContext.cs</code>): DbContext cu DbSet-uri</li>
<li><strong>Migrații</strong> (<code>Repository_CodeFirst/Migrations/</code>): Peste 10 migrații pentru evoluția schemei</li>
</ul>

<p class="no-indent"><strong>Exemplu model Code First:</strong></p>
<div class="code-block">[Table("Carte")]
[Serializable] 
public class Carte
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int id_carte { get; set; }

    [Required]
    [MaxLength(150)]
    public string titlu { get; set; }

    [ForeignKey("Autor")]
    public int id_autor { get; set; }

    public bool IsDeleted { get; set; } = false;

    public virtual Autor Autor { get; set; }
}</div>

<p class="no-indent"><strong>Migrații disponibile:</strong></p>
<ul>
<li><code>migrare1_25_10_2025</code> - Schema inițială</li>
<li><code>SeedInitialData_2025_10_25</code> - Date inițiale</li>
<li><code>AdaugaTabeleNoi_2025_10_25</code> - Tabele noi</li>
<li><code>AddIsDeletedToAutor</code> - Soft Delete pentru Autor</li>
<li><code>AddSerieCategorieToCarte</code> - Relații Serie/Categorie</li>
</ul>

<h3>1.1.4 ORM Database First (Entity Framework)</h3>

<p>În paralel, aplicația demonstrează și abordarea <strong>Database First</strong> pentru scenarii în care baza de date preexistă.</p>

<p><strong>Implementare în proiect:</strong></p>
<ul>
<li><strong>EDMX Model</strong> (<code>Repository_DBFirst/eBooks.edmx</code>): Model generat din schema existentă</li>
<li><strong>Entități generate</strong> (<code>Repository_DBFirst/</code>): Clase generate automat prin T4 templates</li>
</ul>

<p class="no-indent"><strong>Entități mapate:</strong></p>
<ul>
<li><code>Autor</code>, <code>Carte</code>, <code>Categorie</code>, <code>Serie</code></li>
<li><code>Utilizator</code>, <code>TipAbonament</code>, <code>IstoricCitire</code></li>
</ul>

<h3>1.1.5 Dependency Injection (IoC)</h3>

<p>Aplicația implementează <strong>Inversion of Control</strong> folosind containerul <strong>Autofac</strong>.</p>

<p><strong>Implementare în proiect:</strong></p>
<ul>
<li><strong>API</strong>: <code>eBooks_API/Infrastructure/ContainerConfigurer.cs</code> - DI activ</li>
<li><strong>MVC</strong>: <code>eBooks_MVC/App_Start/ContainerConfigurer.cs</code> - DI pregătit</li>
</ul>

<p class="no-indent"><strong>Configurare Autofac (API):</strong></p>
<div class="code-block">public static void ConfigureContainer()
{
    var builder = new ContainerBuilder();

    builder.RegisterApiControllers(Assembly.GetExecutingAssembly());

    builder.RegisterType&lt;eBooksContext&gt;()
           .As&lt;IeBooksContext&gt;()
           .InstancePerLifetimeScope();

    builder.RegisterType&lt;CarteService&gt;()
           .As&lt;ICarteService&gt;()
           .InstancePerLifetimeScope();

    builder.RegisterType&lt;MemoryCacheService&gt;()
           .As&lt;ICache&gt;()
           .SingleInstance();

    var container = builder.Build();
    config.DependencyResolver = new AutofacWebApiDependencyResolver(container);
}</div>

<p class="no-indent"><strong>Lifecycle-uri disponibile:</strong></p>
<table>
<tr><th>Pattern</th><th>Autofac</th><th>Descriere</th></tr>
<tr><td>Singleton</td><td><code>SingleInstance()</code></td><td>O instanță pe aplicație</td></tr>
<tr><td>Scoped</td><td><code>InstancePerLifetimeScope()</code></td><td>O instanță pe request</td></tr>
<tr><td>Transient</td><td><code>InstancePerDependency()</code></td><td>Instanță nouă la fiecare rezolvare</td></tr>
</table>

<h2>1.2 Justificarea Alegerilor</h2>

<h3>De ce MVC?</h3>
<ol>
<li><strong>Separarea responsabilităților</strong>: Permite dezvoltarea independentă a UI, logicii de business și accesului la date</li>
<li><strong>Testabilitate</strong>: Controllerele pot fi testate unitar fără a depinde de UI</li>
<li><strong>Maturitate</strong>: Framework stabil cu documentație extensivă și comunitate activă</li>
<li><strong>Suport Razor</strong>: Sintaxă elegantă pentru template-uri HTML cu C#</li>
</ol>

<h3>De ce Web API?</h3>
<ol>
<li><strong>Interoperabilitate</strong>: Permite consumarea datelor de către aplicații mobile, SPA, sau terți</li>
<li><strong>Standardizare</strong>: Respectă convenții REST pentru predicibilitate</li>
<li><strong>Scalabilitate</strong>: API-ul poate fi scalat independent de interfața web</li>
<li><strong>Separare frontend/backend</strong>: Posibilitatea de a avea aplicații client separate</li>
</ol>

<h3>De ce Code First?</h3>
<ol>
<li><strong>Control total</strong>: Dezvoltatorul definește schema în cod, nu în designer</li>
<li><strong>Versionare</strong>: Migrațiile permit evoluția schemei cu tracking în Git</li>
<li><strong>Domain-Driven Design</strong>: Modelele de domeniu sunt centrale</li>
<li><strong>Agilitate</strong>: Modificările rapide la model se reflectă automat în baza de date</li>
</ol>

<h3>De ce și Database First?</h3>
<ol>
<li><strong>Scenariu academic</strong>: Demonstrează ambele abordări ORM în același proiect</li>
<li><strong>Compatibilitate</strong>: Util când baza de date este gestionată de un DBA extern</li>
<li><strong>Reverse Engineering</strong>: Permite generarea rapidă de cod din schema existentă</li>
</ol>

<h3>De ce Dependency Injection?</h3>
<ol>
<li><strong>Decuplare</strong>: Componentele nu depind de implementări concrete</li>
<li><strong>Testabilitate</strong>: Permite mock-uri și stub-uri în teste unitare</li>
<li><strong>Configurabilitate</strong>: Schimbarea implementării fără modificarea codului client</li>
<li><strong>Single Responsibility</strong>: Fiecare clasă se ocupă doar de responsabilitatea sa</li>
</ol>

<h2>1.3 Arhitectura Aplicației</h2>

<h3>1.3.1 Diagramă Arhitecturală</h3>

<div class="diagram">┌─────────────────────────────────────────────────────────────────────────────┐
│                           PRESENTATION LAYER                                 │
│  ┌─────────────────────────────┐    ┌─────────────────────────────────────┐ │
│  │        eBooks_MVC           │    │           eBooks_API                │ │
│  │    (ASP.NET MVC 5)          │    │       (ASP.NET Web API 2)           │ │
│  │                             │    │                                     │ │
│  │  Controllers:               │    │  Controllers:                       │ │
│  │  - HomeController           │    │  - CartiController                  │ │
│  │  - CartiController          │    │  - AutoriController                 │ │
│  │  - AutoriController         │    │  - ValuesController                 │ │
│  │  - UtilizatorController     │    │                                     │ │
│  │  - AccountController        │    │  Infrastructure:                    │ │
│  │  - AdminController          │    │  - ContainerConfigurer (Autofac)    │ │
│  │                             │    │                                     │ │
│  │  Views (Razor):             │    │  Mapping:                           │ │
│  │  - Home/, Carti/, Autori/   │    │  - AutoMapperConfig                 │ │
│  │  - Account/, Admin/         │    │                                     │ │
│  │  - Utilizator/, Shared/     │    │                                     │ │
│  └─────────────────────────────┘    └─────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            SERVICE LAYER                                     │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                          NivelServicii                                  ││
│  │                                                                         ││
│  │  Services:                        Interfaces:                           ││
│  │  - CarteService                   - ICarteService                       ││
│  │  - AutorService                   - IAutorService                       ││
│  │  - AccesService                   - IAccesService                       ││
│  │  - TestService                    - ITestService                        ││
│  │                                                                         ││
│  │  Cache:                           Funcționalități:                      ││
│  │  - ICache                         - Logică de business                  ││
│  │  - MemoryCacheService             - Validări                            ││
│  │                                   - Caching transparent                 ││
│  │                                   - Logging (NLog)                      ││
│  └─────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DATA ACCESS LAYER                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                      NivelAccessDate_DBFirst                            ││
│  │                                                                         ││
│  │  Accessors (Repository Pattern):                                        ││
│  │  - CarteAccessor         - GetAll(), GetById(), Add(), Update()         ││
│  │  - AutorAccessor         - Delete(), SoftDelete()                       ││
│  │  - CategorieAccessor                                                    ││
│  │  - UtilizatorAccessor    - GetByEmail(), GetByEmailAndPassword()        ││
│  │  - IstoricCitireAccessor                                                ││
│  │  - SerieAccessor                                                        ││
│  │  - TipAbonamentAccessor                                                 ││
│  │  - EdituraAccessor                                                      ││
│  └─────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DATA LAYER                                        │
│  ┌──────────────────────────────┐    ┌────────────────────────────────────┐ │
│  │    Repository_CodeFirst      │    │      Repository_DBFirst           │ │
│  │                              │    │                                    │ │
│  │  Context:                    │    │  EDMX:                             │ │
│  │  - eBooksContext             │    │  - eBooks.edmx                     │ │
│  │  - IeBooksContext            │    │  - Model1.Context.cs               │ │
│  │                              │    │                                    │ │
│  │  Migrations:                 │    │  Generated Entities:               │ │
│  │  - Configuration.cs          │    │  - Autor.cs                        │ │
│  │  - 10+ migrații              │    │  - Carte.cs                        │ │
│  │                              │    │  - Categorie.cs                    │ │
│  │  Funcționalități:            │    │  - Utilizator.cs                   │ │
│  │  - Seed Data                 │    │  - IstoricCitire.cs                │ │
│  │  - Schema Evolution          │    │  - TipAbonament.cs                 │ │
│  │  - Lazy Loading config       │    │  - Serie.cs                        │ │
│  └──────────────────────────────┘    └────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            MODEL LAYER                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                         LibrarieModele                                  ││
│  │                                                                         ││
│  │  Entități de domeniu (POCO):                                            ││
│  │  - Carte (id_carte, titlu, descriere, id_autor, IsDeleted)              ││
│  │  - Autor (id_autor, nume_autor, IsDeleted)                              ││
│  │  - Categorie (id_categorie, denumire, descriere, IsDeleted)             ││
│  │  - Serie (id_serie, nume_serie, descriere)                              ││
│  │  - Utilizator (id_utilizator, nume, email, parola, id_tip_abonament)    ││
│  │  - TipAbonament (id_tip_abonament, denumire, limita_carti, acces_serii) ││
│  │  - IstoricCitire (id_istoric, id_utilizator, id_carte, data_accesare)   ││
│  └─────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DATABASE                                          │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                        SQL Server (eBooks)                              ││
│  │                                                                         ││
│  │  Tabele: Autor, Carte, Categorie, Serie, Editura                        ││
│  │          Utilizator, TipAbonament, IstoricCitire                        ││
│  │          __MigrationHistory (Code First tracking)                       ││
│  └─────────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘</div>

<h3>1.3.2 Descrierea Modulelor</h3>

<h4>Presentation Layer (Nivel de Prezentare)</h4>

<table>
<tr><th>Modul</th><th>Tehnologie</th><th>Responsabilitate</th></tr>
<tr><td><code>eBooks_MVC</code></td><td>ASP.NET MVC 5</td><td>Interfață web pentru utilizatori finali</td></tr>
<tr><td><code>eBooks_API</code></td><td>ASP.NET Web API 2</td><td>Servicii REST pentru integrări externe</td></tr>
</table>

<p><strong>Interacțiuni:</strong></p>
<ul>
<li>Primește cereri HTTP de la browser/client</li>
<li>Orchestrează apeluri către Service Layer</li>
<li>Transformă date în ViewModels/DTOs</li>
<li>Returnează HTML (MVC) sau JSON (API)</li>
</ul>

<h4>Service Layer (Nivel de Servicii)</h4>

<table>
<tr><th>Modul</th><th>Componente</th><th>Responsabilitate</th></tr>
<tr><td><code>NivelServicii</code></td><td>CarteService, AutorService, AccesService</td><td>Logică de business, validări, caching</td></tr>
</table>

<p><strong>Funcționalități implementate:</strong></p>
<ul>
<li><strong>Caching</strong>: Memorare rezultate în <code>MemoryCacheService</code> pentru reducerea încărcării BD</li>
<li><strong>Logging</strong>: Urmărire operații cu NLog</li>
<li><strong>Validări business</strong>: Verificare acces utilizator la cărți bazat pe tip abonament</li>
<li><strong>Soft Delete</strong>: Ștergere logică cu flag <code>IsDeleted</code></li>
</ul>

<p class="no-indent"><strong>Exemplu flux service:</strong></p>
<div class="code-block">public List&lt;Carte&gt; GetAll()
{
    string key = "carti_all";
    if (cache.IsSet(key))
    {
        logger.Info("CARTI : date luate din Cache");
        return cache.Get&lt;List&lt;Carte&gt;&gt;(key);
    }
    logger.Info("CARTI : date luate din BD");
    var carti = carteAccessor.GetAll();
    cache.Set(key, carti);
    return carti;
}</div>

<h4>Data Access Layer (Nivel de Acces la Date)</h4>

<table>
<tr><th>Modul</th><th>Pattern</th><th>Responsabilitate</th></tr>
<tr><td><code>NivelAccessDate_DBFirst</code></td><td>Repository Pattern</td><td>Abstractizare operații CRUD</td></tr>
</table>

<p><strong>Accessors disponibili:</strong></p>
<ul>
<li><code>CarteAccessor</code> - CRUD pentru cărți</li>
<li><code>AutorAccessor</code> - CRUD pentru autori</li>
<li><code>UtilizatorAccessor</code> - CRUD + autentificare</li>
<li><code>IstoricCitireAccessor</code> - Tracking citiri</li>
<li><code>CategorieAccessor</code>, <code>SerieAccessor</code>, <code>TipAbonamentAccessor</code>, <code>EdituraAccessor</code></li>
</ul>

<h4>Data Layer (Nivel de Date)</h4>

<table>
<tr><th>Modul</th><th>Abordare ORM</th><th>Responsabilitate</th></tr>
<tr><td><code>Repository_CodeFirst</code></td><td>Code First</td><td>Definire schema prin cod, migrații</td></tr>
<tr><td><code>Repository_DBFirst</code></td><td>Database First</td><td>Import schema existentă, EDMX</td></tr>
</table>

<p class="no-indent"><strong>DbContext (Code First):</strong></p>
<div class="code-block">public class eBooksContext : DbContext, IeBooksContext
{
    public DbSet&lt;Autor&gt; Autori { get; set; }
    public DbSet&lt;Carte&gt; Carti { get; set; }
    public DbSet&lt;TipAbonament&gt; TipAbonamente { get; set; }
    public DbSet&lt;Categorie&gt; Categorii { get; set; }
    public DbSet&lt;IstoricCitire&gt; IstoricCitiri { get; set; }
    public DbSet&lt;Serie&gt; Serii { get; set; }
    public DbSet&lt;Utilizator&gt; Utilizatori { get; set; }
    public DbSet&lt;Editura&gt; Edituri { get; set; }
}</div>

<h4>Model Layer (Nivel de Modele)</h4>

<table>
<tr><th>Modul</th><th>Tip</th><th>Responsabilitate</th></tr>
<tr><td><code>LibrarieModele</code></td><td>Class Library</td><td>Definiție entități de domeniu (POCO)</td></tr>
</table>

<p><strong>Caracteristici modele:</strong></p>
<ul>
<li>Data Annotations pentru validare și mapare</li>
<li>Navigation Properties pentru relații</li>
<li>Flag <code>IsDeleted</code> pentru soft delete</li>
<li>Atribut <code>[Serializable]</code> pentru caching</li>
</ul>

<h3>1.3.3 Fluxul de Date</h3>

<div class="diagram">┌──────────┐     HTTP      ┌──────────────┐    Service    ┌─────────────┐
│  Client  │ ───────────▶  │  Controller  │ ───────────▶  │   Service   │
│ (Browser)│               │  (MVC/API)   │               │ (Business)  │
└──────────┘               └──────────────┘               └─────────────┘
                                                                 │
                                                                 ▼
┌──────────┐     EF Core   ┌──────────────┐   Repository  ┌─────────────┐
│ SQL Server│ ◀─────────── │  DbContext   │ ◀─────────── │  Accessor   │
│ Database │               │  (EF 6)      │               │  (DAL)      │
└──────────┘               └──────────────┘               └─────────────┘</div>

<p><strong>Exemplu flux complet (Citire cărți):</strong></p>
<ol>
<li><strong>Request</strong>: <code>GET /Carti</code></li>
<li><strong>Controller</strong>: <code>CartiController.Index()</code> apelează <code>carteService.GetAll()</code></li>
<li><strong>Service</strong>: <code>CarteService.GetAll()</code> verifică cache, apelează <code>carteAccessor.GetAll()</code></li>
<li><strong>Accessor</strong>: <code>CarteAccessor.GetAll()</code> execută query LINQ pe <code>eBooksContext.Carti</code></li>
<li><strong>EF</strong>: Traduce LINQ în SQL și execută pe SQL Server</li>
<li><strong>Response</strong>: JSON/HTML cu lista de cărți</li>
</ol>

<h3>1.3.4 Cross-Cutting Concerns</h3>

<h4>Caching</h4>
<div class="code-block">NivelServicii/Cache/
├── ICache.cs              // Interfață pentru caching
└── MemoryCacheService.cs  // Implementare cu MemoryCache</div>

<p><strong>Operații suportate:</strong></p>
<ul>
<li><code>Get&lt;T&gt;(key)</code> - Recuperare din cache</li>
<li><code>Set(key, data, cacheTime)</code> - Salvare în cache</li>
<li><code>IsSet(key)</code> - Verificare existență</li>
<li><code>Remove(key)</code> - Ștergere explicită</li>
<li><code>RemoveByPattern(pattern)</code> - Invalidare pe pattern</li>
<li><code>Clear()</code> - Golire completă</li>
</ul>

<h4>Logging</h4>
<p>Configurat prin <strong>NLog</strong> (<code>eBooks_API/NLog.config</code>):</p>
<ul>
<li>Log la consolă și fișiere</li>
<li>Nivele: Debug, Info, Warn, Error</li>
<li>Rotație automată fișiere</li>
</ul>

<h4>Authentication</h4>
<ul>
<li>Forms Authentication (Web.config)</li>
<li>Session pentru date utilizator</li>
<li>Atribut <code>[Authorize]</code> pe controllere</li>
</ul>

<h2>1.4 Diagrama Entitate-Relație</h2>

<div class="diagram">┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐
│   TipAbonament  │         │   Utilizator    │         │ IstoricCitire   │
├─────────────────┤         ├─────────────────┤         ├─────────────────┤
│ PK id_tip_abon  │◀────────│ PK id_utilizator│────────▶│ PK id_istoric   │
│    denumire     │    1:N  │    nume_utiliz  │  1:N    │ FK id_utilizator│
│ limita_carti    │         │    email        │         │ FK id_carte     │
│ acces_serii     │         │    parola       │         │    data_accesare│
│ permite_desc    │         │ FK id_tip_abon  │         │    actiune      │
└─────────────────┘         │ carti_citite_luna│         └────────┬────────┘
                            └─────────────────┘                   │
                                                                  │ N:1
┌─────────────────┐         ┌─────────────────┐                   │
│     Autor       │         │     Carte       │◀──────────────────┘
├─────────────────┤         ├─────────────────┤
│ PK id_autor     │◀────────│ PK id_carte     │
│    nume_autor   │    1:N  │    titlu        │
│    IsDeleted    │         │    descriere    │
└─────────────────┘         │ FK id_autor     │
                            │ FK id_categorie │──────────┐
                            │ FK id_serie     │────────┐ │
                            │    nr_volum     │        │ │
                            │    IsDeleted    │        │ │
                            └─────────────────┘        │ │
                                                       │ │
┌─────────────────┐         ┌─────────────────┐        │ │
│     Serie       │         │   Categorie     │        │ │
├─────────────────┤         ├─────────────────┤        │ │
│ PK id_serie     │◀────────┤ PK id_categorie │◀───────┼─┘
│    nume_serie   │    1:N  │    denumire     │   1:N  │
│    descriere    │         │    descriere    │        │
└─────────────────┘         │    IsDeleted    │        │
        ▲                   └─────────────────┘        │
        │                                              │
        └──────────────────────────────────────────────┘</div>

<h2>1.5 Structura Soluției Visual Studio</h2>

<div class="code-block">ProiectPPAW.sln
│
├── eBooks_MVC/                    # Aplicație Web MVC
│   ├── App_Start/                 # Configurare (Routing, Bundles, Autofac)
│   ├── Controllers/               # Controllere MVC
│   ├── Models/                    # ViewModels
│   ├── Views/                     # Razor Views
│   ├── Content/                   # CSS, imagini
│   ├── Scripts/                   # JavaScript
│   └── Web.config                 # Configurare aplicație
│
├── eBooks_API/                    # Aplicație Web API
│   ├── App_Start/                 # Configurare WebApi
│   ├── Controllers/               # Controllere API
│   ├── Infrastructure/            # DI Container (Autofac)
│   ├── Mapping/                   # AutoMapper profiles
│   └── Models/                    # DTOs
│
├── NivelServicii/                 # Service Layer
│   ├── Cache/                     # Caching infrastructure
│   ├── *Service.cs                # Implementări servicii
│   └── I*Service.cs               # Interfețe servicii
│
├── NivelAccessDate_DBFirst/       # Data Access Layer
│   └── *Accessor.cs               # Repository implementations
│
├── Repository_CodeFirst/          # Code First ORM
│   ├── LibrarieModele/            # Entități de domeniu
│   ├── Migrations/                # EF Migrations
│   ├── eBooksContext.cs           # DbContext
│   └── IeBooksContext.cs          # Interfață context
│
├── Repository_DBFirst/            # Database First ORM
│   ├── eBooks.edmx                # Entity Data Model
│   └── *.cs                       # Entități generate
│
├── Test_CodeFirst/                # Teste Code First
└── TestORM_SchemaFirst/           # Teste Database First</div>

<h2>1.6 Concluzii</h2>

<p>Arhitectura aplicației <strong>eBooks</strong> este construită pe principii solide de design software:</p>

<ol>
<li><strong>Separarea în straturi</strong> permite dezvoltarea și testarea independentă a componentelor</li>
<li><strong>Utilizarea ambelor abordări ORM</strong> demonstrează flexibilitatea Entity Framework</li>
<li><strong>Pattern-ul Repository</strong> abstractizează accesul la date și facilitează testarea</li>
<li><strong>Dependency Injection</strong> reduce cuplarea și îmbunătățește mentenabilitatea</li>
<li><strong>Caching la nivel de serviciu</strong> optimizează performanța fără a complica DAL-ul</li>
<li><strong>API REST separat</strong> permite integrări externe și dezvoltare frontend decuplată</li>
</ol>

<p>Aceste alegeri arhitecturale asigură scalabilitatea, mentenabilitatea și testabilitatea aplicației pe termen lung.</p>

<br/><br/>
<p class="center" style="color: #666; font-size: 10pt;">
— Sfârșitul Capitolului 1 —
</p>

</body>
</html>
