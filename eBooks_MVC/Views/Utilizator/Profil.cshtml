@model eBooks_MVC.Models.UtilizatorViewModel

@{
    ViewBag.Title = "Profil Utilizator";
}

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade in" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        @TempData["Success"]
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade in" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        @TempData["Error"]
    </div>
}

<h2>Profil Utilizator</h2>

<div>
    <h4>@Model.nume_utilizator</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>@Html.DisplayNameFor(model => model.nume_utilizator)</dt>
        <dd>@Html.DisplayFor(model => model.nume_utilizator)</dd>

        <dt>@Html.DisplayNameFor(model => model.email)</dt>
        <dd>@Html.DisplayFor(model => model.email)</dd>

        <dt>@Html.DisplayNameFor(model => model.data_inregistrare)</dt>
        <dd>@Html.DisplayFor(model => model.data_inregistrare)</dd>

        <dt>@Html.DisplayNameFor(model => model.denumire_plan)</dt>
        <dd>
            <span class="badge badge-info">@Model.denumire_plan</span>
            @if (Model.denumire_plan == "Free")
            {
                <span class="text-muted">(Cont Free)</span>
            }
            else if (Model.denumire_plan == "Premium")
            {
                <span class="text-success">(Cont Premium)</span>
            }
            else if (Model.denumire_plan == "VIP")
            {
                <span class="text-warning">(Cont VIP)</span>
            }
        </dd>

        <dt>@Html.DisplayNameFor(model => model.carti_citite_luna)</dt>
        <dd>
            @if (Model.limita_carti_pe_luna == -1)
            {
                <span>@Model.carti_citite_luna / <strong>Nelimitat</strong> (VIP)</span>
            }
            else
            {
                @Model.carti_citite_luna <text>/</text> @Model.limita_carti_pe_luna
                if (Model.carti_citite_luna >= Model.limita_carti_pe_luna)
                {
                    <span class="text-danger">(Limita atinsa)</span>
                }
                else
                {
                    <span class="text-success">(@(Model.limita_carti_pe_luna - Model.carti_citite_luna) ramase)</span>
                }
            }
        </dd>
    </dl>
</div>

@if (ViewBag.AvailablePlans != null && ((System.Collections.Generic.IEnumerable<System.Web.Mvc.SelectListItem>)ViewBag.AvailablePlans).Any())
{
    <div class="panel panel-warning">
        <div class="panel-heading">
            <h4>Upgrade Cont</h4>
        </div>
        <div class="panel-body">
            <p>Puteti face upgrade la un plan superior pentru mai multe functionalitati:</p>
            @using (Html.BeginForm("UpgradeCont", "Utilizator", FormMethod.Post, new { id = "upgradeForm" }))
            {
                @Html.AntiForgeryToken()
                <div class="form-group">
                    <label for="idTipAbonamentNou">Selecteaza noul plan:</label>
                    @Html.DropDownList("idTipAbonamentNou", (IEnumerable<SelectListItem>)ViewBag.AvailablePlans, "-- Selecteaza un plan --", new { @class = "form-control", style = "margin-bottom: 10px;", required = "required" })
                </div>
                <button type="submit" class="btn btn-warning">Upgrade Cont</button>
            }
        </div>
    </div>
}

<div style="margin-top: 20px;">
    <p>
        @Html.ActionLink("Planuri de Abonament", "Index", "Utilizator", null, new { @class = "btn btn-info" })
        <a href="@Url.Action("Carti", "Utilizator")" class="btn btn-primary" style="margin-left: 10px;">Carti Disponibile</a>
        @Html.ActionLink("Istoric Citire", "Istoric", "Utilizator", null, new { @class = "btn btn-default", style = "margin-left: 10px;" })
        @Html.ActionLink("Logout", "Logout", "Account", null, new { @class = "btn btn-danger", style = "margin-left: 10px;" })
    </p>
</div>
